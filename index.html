<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>147è‡ªæ¸¬ç¶²ç«™å…¥å£</title>
 <link rel="icon" type="image/png" href="favicon-OIP.jpg?v=3">
<link rel="apple-touch-icon" href="favicon-OIP.jpg?v=3">

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@500;600;700&display=swap" rel="stylesheet" />

  <style>
    :root{
      /* âœ… ä¸­æ€§æ·±è‰²ï¼šä¸è—ã€ä¸éœ“è™¹ */
      --bg:#0b0c10;
      --panel:#11131a;
      --panel2:#0f1117;
      --line: rgba(255,255,255,.10);
      --line2: rgba(255,255,255,.14);

      --txt:#eef0ff;
      --muted: rgba(220,226,255,.72);

      /* å°é»ç¶´è‰²ï¼šåªç”¨åœ¨é¸å–/ç„¦é»ï¼Œä¸æœƒæ•´é è®Šç´«è— */
      --accent: rgba(167,139,250,.95); /* violet */
      --accentBg: rgba(167,139,250,.12);

      --r:14px;
      --r2:12px;
      --gap:8px;

      /* å‹•ç•« */
      --ease:cubic-bezier(.2,.8,.2,1);
      --t120:120ms var(--ease);
      --t180:180ms var(--ease);
      --t260:260ms var(--ease);
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      color:var(--txt);
      font-family:"Microsoft JhengHei", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: var(--bg);
      overflow-x:hidden;
    }

    /* å¾ˆæ·¡çš„è³ªæ„Ÿé»é»ï¼ˆä½ ä¹Ÿå¯ä»¥æ”¹æˆ display:noneï¼‰ */
    .noise{
      position:fixed; inset:0; pointer-events:none; z-index:0;
      opacity:.06;
      background-image: radial-gradient(rgba(255,255,255,.10) 1px, transparent 1px);
      background-size: 22px 22px;
      mix-blend-mode: overlay;
    }

    .app{
      position:relative;
      z-index:1;
      min-height:100vh;
      display:flex;
      flex-direction:column;
    }

    /* ===== Topbar (ç³»çµ±åŒ– App Bar) ===== */
    .topbar{
      position:sticky;
      top:0;
      z-index:10;
      background: rgba(11,12,16,.92);
      border-bottom: 1px solid rgba(255,255,255,.08);
      backdrop-filter: blur(8px);
      box-shadow: 0 10px 28px rgba(0,0,0,.28);
    }
    .topbarInner{
      display:flex;
      align-items:center;
      gap: 10px;
      padding: 9px 10px; /* âœ… æ›´çœç©ºé–“ */
      flex-wrap:wrap;
    }

    .brand{
      display:flex;
      align-items:center;
      gap:10px;
      min-width: 210px;
      flex: 0 0 auto;
    }
    .logo{
      width:36px;height:36px;
      border-radius: 12px;
      background: var(--panel);
      border: 1px solid var(--line);
    }
    .brandTxt{ line-height:1.15; }
    .brandTxt .t{
      margin:0;
      font-family:"Noto Serif TC","Microsoft JhengHei",serif;
      font-weight:700;
      font-size:15px;
      letter-spacing:.6px;
      color:#fff;
    }
    .brandTxt .s{
      margin-top:4px;
      font-size:12px;
      color:var(--muted);
      font-weight:850;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      max-width: 240px;
    }

    .search{
      flex: 1 1 360px;
      display:flex;
      align-items:center;
      gap:8px;
      padding: 8px 10px;
      border-radius: var(--r);
      background: var(--panel2);
      border: 1px solid var(--line);
      min-width: 220px;
      transition: border-color var(--t180), box-shadow var(--t180);
    }
    .search .ic{ opacity:.85; font-size:14px; }
    .search input{
      width:100%;
      border:0;
      outline:none;
      background: transparent;
      color: var(--txt);
      font-size:13.5px;
      font-weight:850;
    }
    .search input::placeholder{ color: rgba(220,226,255,.55); }
    .search:focus-within{
      border-color: rgba(167,139,250,.40);
      box-shadow: 0 0 0 3px rgba(167,139,250,.12);
    }

    .actions{
      display:flex;
      align-items:center;
      gap:8px;
      flex-wrap:wrap;
      justify-content:flex-end;
      flex: 1 1 auto;
      min-width: 0;
    }

    .ctl{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 7px 10px;
      border-radius: 999px;
      background: var(--panel2);
      border: 1px solid var(--line);
      font-size:12px;
      font-weight:950;
      color: var(--txt);
      white-space:nowrap;
    }
    .ctl .mut{ color: var(--muted); font-weight:850; }

    select.sel{
      border: 1px solid var(--line);
      background: var(--panel2);
      color: var(--txt);
      padding: 7px 10px;
      border-radius: 12px;
      font-weight:950;
      font-size:12px;
      outline:none;
    }

    .btn{
      cursor:pointer;
      user-select:none;
      border: 1px solid var(--line);
      background: var(--panel2);
      color: var(--txt);
      padding: 7px 10px;
      border-radius: 12px;
      font-weight:950;
      font-size:12px;
      white-space:nowrap;
      transition: transform var(--t120), background var(--t180), border-color var(--t180), opacity var(--t180);
    }
    .btn:hover{ transform: translateY(-1px); border-color: rgba(255,255,255,.18); }
    .btn:active{ transform: translateY(0); opacity:.92; }
    .btn.on{
      border-color: rgba(167,139,250,.45);
      background: rgba(167,139,250,.10);
    }

    /* ===== Body grid ===== */
    .body{
      display:grid;
      grid-template-columns: 220px minmax(0,1fr); /* âœ… æ›´çª„ */
      gap: var(--gap);
      padding: 10px;
    }

    /* ===== Sidebar (å°è¦½) ===== */
    .side{
      align-self:start;
      position:sticky;
      top: 62px;
      background: var(--panel);
      border: 1px solid var(--line);
      border-radius: var(--r);
      overflow:hidden;
      box-shadow: 0 10px 28px rgba(0,0,0,.28);
    }
    .sideHead{
      padding: 10px 10px 8px;
      border-bottom: 1px solid rgba(255,255,255,.08);
    }
    .sideHead .h{
      margin:0;
      font-size:12px;
      letter-spacing:.6px;
      color: rgba(220,226,255,.78);
      font-weight:1000;
    }

    .nav{
      padding: 8px;
      display:flex;
      flex-direction:column;
      gap:6px;
    }
    .navBtn{
      width:100%;
      cursor:pointer;
      border: 1px solid transparent;
      background: transparent;
      color: var(--txt);
      border-radius: 12px;
      padding: 8px 9px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      font-weight:950;
      text-align:left;
      transition: transform var(--t120), background var(--t180), border-color var(--t180), opacity var(--t180);
    }
    .navBtn:hover{
      transform: translateY(-1px);
      background: rgba(255,255,255,.05);
      border-color: rgba(255,255,255,.06);
    }
    .navBtn:active{ transform: translateY(0); opacity:.92; }
    .navBtn.active{
      background: var(--accentBg);
      border-color: rgba(167,139,250,.28);
    }
    .navLeft{
      display:flex;
      align-items:center;
      gap:10px;
      min-width:0;
    }
    .dot{
      width:9px;height:9px;border-radius:999px;
      background: rgba(255,255,255,.22);
      flex:0 0 auto;
    }
    .navBtn.active .dot{ background: rgba(167,139,250,.90); }

    .navLabel{
      min-width:0;
      overflow:hidden;
      white-space:nowrap;
      text-overflow:ellipsis;
      font-size:13px;
    }
    .badge{
      flex:0 0 auto;
      padding: 3px 7px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.05);
      color: rgba(220,226,255,.85);
      font-size: 11.5px;
      font-weight:1000;
    }

    .sideFoot{
      padding: 10px 10px 12px;
      border-top: 1px solid rgba(255,255,255,.08);
      color: rgba(220,226,255,.65);
      font-size: 12px;
      line-height: 1.55;
    }
    .kbd{
      display:inline-block;
      padding: 1px 7px;
      border-radius: 8px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color: var(--txt);
      font-weight:900;
      font-size: 11px;
      margin: 0 2px;
    }

    /* ===== Main ===== */
    .main{
      min-width:0;
      background: var(--panel);
      border: 1px solid var(--line);
      border-radius: var(--r);
      overflow:hidden;
      box-shadow: 0 10px 28px rgba(0,0,0,.28);
    }
    .mainHead{
      padding: 10px 10px 10px;
      border-bottom: 1px solid rgba(255,255,255,.08);
      display:flex;
      align-items:flex-end;
      justify-content:space-between;
      gap: 10px;
      flex-wrap:wrap;
    }
    .mainHead .ttl{
      margin:0;
      font-family:"Noto Serif TC","Microsoft JhengHei",serif;
      font-size:18px;
      letter-spacing:.6px;
      color:#fff;
    }
    .mainHead .sub{
      margin:6px 0 0;
      color: var(--muted);
      font-size:12.8px;
      font-weight:850;
    }
    .stats{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      justify-content:flex-end;
      align-items:center;
    }
    .stat{
      padding: 7px 10px;
      border-radius: 999px;
      background: var(--panel2);
      border: 1px solid var(--line);
      font-size:12px;
      font-weight:950;
      white-space:nowrap;
    }
    .stat b{ color:#fff; }
    .stat .m{ color: var(--muted); font-weight:850; margin-left:6px; }

    /* ===== Content ===== */
    .content{
      padding: 10px;
      display:grid;
      gap:10px;
      min-width:0;
    }

    .section{
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(15,17,23,.40);
      border-radius: var(--r);
      overflow:hidden;
      min-width:0;

      /* é€²å ´ï¼šé è¨­å…ˆè— */
      opacity: 0;
      transform: translateY(6px);
    }

    .sectionHead{
      padding: 9px 10px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      border-bottom: 1px solid rgba(255,255,255,.08);
      background: rgba(255,255,255,.03);
    }
    .sectionHead .name{
      font-weight:1000;
      font-size: 13px;
      letter-spacing:.4px;
    }
    .sectionHead .count{
      color: var(--muted);
      font-weight:950;
      font-size: 12px;
    }

    .table{
      display:flex;
      flex-direction:column;
    }

    .thead{
      display:grid;
      grid-template-columns: 1fr 140px 170px;
      gap:10px;
      padding: 8px 10px;
      border-bottom: 1px solid rgba(255,255,255,.08);
      color: rgba(220,226,255,.70);
      font-size: 12px;
      font-weight:1000;
    }

    .tr{
      display:grid;
      grid-template-columns: 1fr 140px 170px;
      gap:10px;
      padding: 9px 10px;  /* âœ… å¯†åº¦æ›´é«˜ */
      border-bottom: 1px solid rgba(255,255,255,.06);
      align-items:center;
      min-width:0;

      /* é€²å ´ï¼šé è¨­å…ˆè— */
      opacity: 0;
      transform: translateY(6px);
    }
    .tr:last-child{ border-bottom:0; }
    .tr:hover{ background: rgba(255,255,255,.035); }

    .tTitle{
      min-width:0;
      display:flex;
      flex-direction:column;
      gap:6px;
    }
    .tTitle .name{
      font-weight:1000;
      font-size: 14.5px;
      line-height: 1.25;
      word-break:break-word;
    }
    .tTitle .kw{
      font-size: 12px;
      color: rgba(220,226,255,.58);
      font-weight:850;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    .tag{
      display:inline-flex;
      align-items:center;
      justify-content:flex-start;
      padding: 4px 8px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.05);
      color: rgba(220,226,255,.80);
      font-weight:950;
      font-size: 11.5px;
      width: fit-content;
      max-width: 100%;
      overflow:hidden;
      text-overflow:ellipsis;
      white-space:nowrap;
    }

    .tActs{
      display:flex;
      justify-content:flex-end;
      gap:8px;
      flex-wrap:wrap;
    }

    .go, .fav{
      cursor:pointer;
      text-decoration:none;
      color: var(--txt);
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      padding: 8px 10px;
      border-radius: 12px;
      font-weight:1000;
      font-size: 12px;
      white-space:nowrap;
      transition: transform var(--t120), background var(--t180), border-color var(--t180), opacity var(--t180);
    }
    .go:hover, .fav:hover{ transform: translateY(-1px); border-color: rgba(255,255,255,.20); }
    .go:active, .fav:active{ transform: translateY(0); opacity:.92; }

    .fav.on{
      border-color: rgba(167,139,250,.45);
      background: rgba(167,139,250,.10);
    }

    .empty{
      padding: 14px 12px;
      border-radius: var(--r);
      border: 1px dashed rgba(255,255,255,.16);
      background: rgba(15,17,23,.35);
      color: rgba(220,226,255,.70);
      text-align:center;
      font-weight:950;
      margin: 10px;
    }

    footer{
      text-align:center;
      color: rgba(231,238,255,.60);
      font-size: 12.5px;
      padding: 14px 10px 22px;
    }

    /* ===== Density mode ===== */
    .dense .topbarInner{ padding: 8px 9px; }
    .dense .body{ padding: 8px; gap: 8px; }
    .dense .mainHead{ padding: 9px 9px; }
    .dense .content{ padding: 8px; gap: 8px; }
    .dense .tr{ padding: 8px 10px; }
    .dense .thead{ padding: 7px 10px; }
    .dense .navBtn{ padding: 7px 8px; }

    /* ===== Responsive ===== */
    @media (max-width: 980px){
      .body{ grid-template-columns: 1fr; }
      .side{ position:relative; top:auto; }
      .brand{ min-width:0; }
      .actions{ justify-content:flex-start; width:100%; }
    }

    @media (max-width: 760px){
      .thead{ display:none; }
      .tr{
        grid-template-columns: 1fr;
        gap: 8px;
      }
      .tActs{ justify-content:flex-start; }
    }

    /* ===== å‹•ç•«èˆ‡ç‰¹æ•ˆ ===== */

    /* render å¾Œå¥— class */
    .section.in, .tr.in{
      opacity: 1;
      transform: translateY(0);
      transition: opacity var(--t260), transform var(--t260);
    }

    /* pill loading shimmer */
    .ctl.loading{
      position:relative;
      overflow:hidden;
    }
    .ctl.loading:after{
      content:"";
      position:absolute;
      inset:0;
      transform: translateX(-120%);
      background: linear-gradient(90deg, transparent, rgba(255,255,255,.10), transparent);
      animation: shimmer 1.1s linear infinite;
      pointer-events:none;
    }
    @keyframes shimmer{
      to{ transform: translateX(120%); }
    }

    /* Ripple */
    .ripple{ position:relative; overflow:hidden; }
    .ripple .rip{
      position:absolute;
      border-radius:999px;
      transform: scale(0);
      opacity:.35;
      background: rgba(255,255,255,.55);
      animation: rip 520ms var(--ease);
      pointer-events:none;
    }
    @keyframes rip{
      to{ transform: scale(3.2); opacity:0; }
    }

    /* Toast */
    .toast{
      position:fixed;
      left:50%;
      bottom: 18px;
      transform: translateX(-50%) translateY(12px);
      background: rgba(15,17,23,.92);
      border: 1px solid rgba(255,255,255,.10);
      color: var(--txt);
      padding: 10px 12px;
      border-radius: 999px;
      box-shadow: 0 14px 30px rgba(0,0,0,.40);
      font-weight: 950;
      font-size: 12.5px;
      opacity:0;
      transition: opacity var(--t180), transform var(--t180);
      z-index: 999;
      pointer-events:none;
      white-space:nowrap;
    }
    .toast.show{
      opacity:1;
      transform: translateX(-50%) translateY(0);
    }

    /* æ¸›å°‘å‹•ä½œï¼šè‡ªå‹•é—œå‹•ç•« */
    @media (prefers-reduced-motion: reduce){
      .navBtn, .btn, .go, .fav, .search{ transition:none; }
      .section, .tr{ opacity:1; transform:none; }
      .ctl.loading:after{ display:none; }
      .ripple .rip{ display:none; }
    }
  </style>
</head>

<body>
  <div class="noise" aria-hidden="true"></div>

  <div class="app" id="app">

    <!-- Topbar -->
    <header class="topbar" aria-label="ä¸Šæ–¹åˆ—">
      <div class="topbarInner">
        <div class="brand">
          <div class="logo" style="background-image:url('OIP.jpg'); background-size:cover; background-position:center; border:none;"></div>

          <div class="brandTxt">
            <div class="t">147è‡ªæ¸¬ç¶²ç«™å…¥å£</div>
            <div class="s">ç›®å‰ç‰ˆæœ¬-2.1
            </div>
          </div>
        </div>

        <div class="search" aria-label="æœå°‹">
          <span class="ic" aria-hidden="true">ğŸ”</span>
          <input id="q" type="search" placeholder="æœå°‹:" autocomplete="off" />
        </div>

        <div class="actions" aria-label="æ§åˆ¶">
          <span class="ctl" id="clockPill">ğŸ•’ <span class="mut">è¼‰å…¥ä¸­â€¦</span></span>
          <span class="ctl" id="weatherPill">â³ <span class="mut">å¤©æ°£è®€å–ä¸­â€¦</span></span>

          <select class="sel" id="sortSel" title="æ’åº">
            <option value="smart">æ’åºï¼šæ™ºæ…§</option>
            <option value="title">æ’åºï¼šæ¨™é¡Œ Aâ†’Z</option>
            <option value="group">æ’åºï¼šåˆ†é¡</option>
            <option value="recent">æ’åºï¼šæœ€è¿‘é–‹å•Ÿ</option>
            <option value="fav">æ’åºï¼šæ”¶è—å„ªå…ˆ</option>
          </select>

          <button class="btn" id="btnGroup" type="button" title="ç¾¤çµ„/æ‰å¹³">ç¾¤çµ„ï¼šé–‹</button>
          <button class="btn" id="btnDense" type="button" title="å¯†åº¦">å¯†åº¦ï¼šä¸€èˆ¬</button>
        </div>
      </div>
    </header>

    <!-- Body -->
    <div class="body">

      <!-- Sidebar -->
      <aside class="side" aria-label="å°è¦½">
        <div class="sideHead">
          <p class="h">åˆ†é¡</p>
        </div>
        <div class="nav" id="nav"></div>
        <div class="sideFoot">
          å¿«æ·éµï¼š<span class="kbd">/</span> èšç„¦æœå°‹ã€<span class="kbd">Esc</span> æ¸…ç©º<br/>
          æç¤ºï¼šæ”¶è—å›ºå®šå¸¸ç”¨ï¼›æœ€è¿‘é–‹å•Ÿæœƒè¨˜éŒ„ã€‚<br/>
          |ç‰ˆæ¬ŠåŠæºä»£ç¢¼æ‰€å±¬èˆªæ©Ÿç³»008æ²ˆå´‘å®¸| |å»ºè­°ä½¿ç”¨é›»è…¦ç‰ˆç¶²é |
        </div>
      </aside>

      <!-- Main -->
      <main class="main" aria-label="å…§å®¹">
        <div class="mainHead">
          <div>
            <div class="ttl" id="viewTitle">å…¨éƒ¨</div>
            <div class="sub" id="viewSub">ç³»çµ±åŒ–æ¸…å–®ä»‹é¢ï½œå¯æ’åº/ç¾¤çµ„/å¯†åº¦</div>
          </div>
          <div class="stats">
            <div class="stat" id="statTotal">ç¸½æ•¸ <b>0</b><span class="m">é …</span></div>
            <div class="stat" id="statShown">é¡¯ç¤º <b>0</b><span class="m">é …</span></div>
            <div class="stat" id="statFav">æ”¶è— <b>0</b><span class="m">é …</span></div>
          </div>
        </div>

        <div class="content" id="content"></div>

        <div class="empty" id="empty" style="display:none;">
          æ‰¾ä¸åˆ°ç¬¦åˆçš„é …ç›®ï¼ˆè©¦è©¦çœ‹ç¸®çŸ­é—œéµå­—æˆ–åˆ‡å›ã€Œå…¨éƒ¨ã€ï¼‰
        </div>
      </main>

    </div>

    <footer>
      Â© 2025 èˆªæ©Ÿç³» 008 æ²ˆå´‘å®¸ | Powered by GitHub Pages | å¦‚æœä½ è¦ºå¾—é€™ç¶²é å¾ˆæ£’å¯ä»¥è«‹æˆ‘å–é£²æ–™çœŸçš„ | ig:kun.chen.0826
    </footer>
  </div>

  <div class="toast" id="toast" aria-live="polite"></div>

  <script>
    /* =========================
       ä½ çš„ã€Œåç¨± + ç¶²å€ã€å®Œå…¨ä¿ç•™
       ========================= */
    var DATA = [
      // 147å…¥å­¸è€ƒ
      {section:'147', group:'147å…¥å­¸è€ƒ', title:'ğŸ“˜ ALL-å…¥å­¸è€ƒ', url:'https://hisausage7.github.io/147/', keywords:'147 å…¥å­¸è€ƒ å…¥å­¸ ALL'},
      {section:'147', group:'147å…¥å­¸è€ƒ', title:'ğŸ“˜ M6-å…¥å­¸è€ƒ', url:'https://hisausage7.github.io/147in-M6/', keywords:'147 å…¥å­¸è€ƒ å…¥å­¸ M6'},
      {section:'147', group:'147å…¥å­¸è€ƒ', title:'ğŸ“˜ M7-å…¥å­¸è€ƒ', url:'https://hisausage7.github.io/147in-M7/', keywords:'147 å…¥å­¸è€ƒ å…¥å­¸ M7'},
      {section:'147', group:'147å…¥å­¸è€ƒ', title:'ğŸ“˜ M10-å…¥å­¸è€ƒ', url:'https://hisausage7.github.io/147in/', keywords:'147 å…¥å­¸è€ƒ å…¥å­¸ M10'},

      // 147æ ¡å…§è€ƒ
      {section:'int', group:'147æ ¡å…§è€ƒ', title:'âš™ï¸ M1-æ ¡å…§è€ƒ', url:'https://hisausage7.github.io/147M1/', keywords:'M1 æ ¡å…§è€ƒ 147M1'},
      {section:'int', group:'147æ ¡å…§è€ƒ', title:'âš™ï¸ M3-æ ¡å…§è€ƒ(å»ºç½®ä¸­)', url:'https://www.youtube.com/watch?v=dQw4w9WgXcQ&list=RDdQw4w9WgXcQ&start_radio=1', keywords:'M3 æ ¡å…§è€ƒ 147M3 å»ºç½®ä¸­'},
      {section:'int', group:'147æ ¡å…§è€ƒ', title:'âš™ï¸ M6-æ ¡å…§è€ƒ(ç„¡6.3åŠ6.11)', url:'https://hisausage7.github.io/147M6/', keywords:'M6 æ ¡å…§è€ƒ 147M6 ç„¡6.3 ç„¡6.11'},
      {section:'int', group:'147æ ¡å…§è€ƒ', title:'âš™ï¸ M9-æ ¡å…§è€ƒ', url:'https://hisausage7.github.io/147M9/', keywords:'M9 æ ¡å…§è€ƒ 147M9'},
      {section:'int', group:'147æ ¡å…§è€ƒ', title:'âš™ï¸ M10-æ ¡å…§è€ƒ(å»ºç½®ä¸­)', url:'https://www.youtube.com/watch?v=dQw4w9WgXcQ&list=RDdQw4w9WgXcQ&start_radio=1', keywords:'M10 æ ¡å…§è€ƒ 147M10 å»ºç½®ä¸­'},
      {section:'int', group:'147æ ¡å…§è€ƒ', title:'âš™ï¸ M15-æ ¡å…§è€ƒ', url:'https://hisausage7.github.io/147M15/', keywords:'M15 æ ¡å…§è€ƒ 147M15'},

      // 147æœŸä¸­/æœ«è€ƒ
      {section:'test', group:'147æœŸä¸­/æœ«è€ƒ', title:'âš™ï¸ M6-æœŸæœ«è€ƒ', url:'https://hisausage7.github.io/147-M6mid/', keywords:'M6 æœŸä¸­è€ƒ 147M6mid'},
      {section:'test', group:'147æœŸä¸­/æœ«è€ƒ', title:'âš™ï¸ M15-æœŸæœ«è€ƒ', url:'https://hisausage7.github.io/M15-mid/', keywords:'M15 æœŸæœ«è€ƒ M15-mid'},

      // 147CAA
      {section:'caa', group:'147CAA', title:'ğŸ›©ï¸ M1-CAA', url:'https://hisausage7.github.io/147CAA-M1/', keywords:'CAA æ°‘èˆª 147CAA M1'},
      {section:'caa', group:'147CAA', title:'ğŸ›©ï¸ M9-CAA', url:'https://hisausage7.github.io/147CAA-M9/', keywords:'CAA æ°‘èˆª 147CAA M9'},

      // æŠ€è—ç«¶è³½
      {section:'skill', group:'æŠ€è—ç«¶è³½', title:'ğŸ› ï¸ M1 æŠ€è—ç«¶è³½', url:'https://hisausage7.github.io/skill-M1/', keywords:'æŠ€èƒ½ æª¢å®š skill M1 1'},
      {section:'skill', group:'æŠ€è—ç«¶è³½', title:'ğŸ› ï¸ M2 æŠ€è—ç«¶è³½', url:'https://hisausage7.github.io/skill-M2/', keywords:'æŠ€èƒ½ æª¢å®š skill M2 2'},
      {section:'skill', group:'æŠ€è—ç«¶è³½', title:'ğŸ› ï¸ M3 æŠ€è—ç«¶è³½', url:'https://hisausage7.github.io/skill-M3/', keywords:'æŠ€èƒ½ æª¢å®š skill M3 3'},
      {section:'skill', group:'æŠ€è—ç«¶è³½', title:'ğŸ› ï¸ M4 æŠ€è—ç«¶è³½', url:'https://hisausage7.github.io/skill-M4/', keywords:'æŠ€èƒ½ æª¢å®š skill M4 4'},
      {section:'skill', group:'æŠ€è—ç«¶è³½', title:'ğŸ› ï¸ M5 æŠ€è—ç«¶è³½', url:'https://hisausage7.github.io/skill-M5/', keywords:'æŠ€èƒ½ æª¢å®š skill M5 5'},
      {section:'skill', group:'æŠ€è—ç«¶è³½', title:'ğŸ› ï¸ M6 æŠ€è—ç«¶è³½', url:'https://hisausage7.github.io/skill-M6/', keywords:'æŠ€èƒ½ æª¢å®š skill M6 6'},
      {section:'skill', group:'æŠ€è—ç«¶è³½', title:'ğŸ› ï¸ M7 æŠ€è—ç«¶è³½', url:'https://hisausage7.github.io/skill-M7/', keywords:'æŠ€èƒ½ æª¢å®š skill M7 7'},
      {section:'skill', group:'æŠ€è—ç«¶è³½', title:'ğŸ› ï¸ M8 æŠ€è—ç«¶è³½', url:'https://hisausage7.github.io/skill-M8/', keywords:'æŠ€èƒ½ æª¢å®š skill M8 8'},
      {section:'skill', group:'æŠ€è—ç«¶è³½', title:'ğŸ› ï¸ M9 æŠ€è—ç«¶è³½', url:'https://hisausage7.github.io/skill-M9/', keywords:'æŠ€èƒ½ æª¢å®š skill M9 9'},
      {section:'skill', group:'æŠ€è—ç«¶è³½', title:'ğŸ› ï¸ M10 æŠ€è—ç«¶è³½', url:'https://hisausage7.github.io/skill-M10/', keywords:'æŠ€èƒ½ æª¢å®š skill M10 10'},
      {section:'skill', group:'æŠ€è—ç«¶è³½', title:'ğŸ› ï¸ M11A æŠ€è—ç«¶è³½', url:'https://hisausage7.github.io/skill-M11A/', keywords:'æŠ€èƒ½ æª¢å®š skill M11A 11A'},
      {section:'skill', group:'æŠ€è—ç«¶è³½', title:'ğŸ› ï¸ M11B æŠ€è—ç«¶è³½', url:'https://hisausage7.github.io/skill-M11B/', keywords:'æŠ€èƒ½ æª¢å®š skill M11B 11B'},
      {section:'skill', group:'æŠ€è—ç«¶è³½', title:'ğŸ› ï¸ M12 æŠ€è—ç«¶è³½', url:'https://hisausage7.github.io/skill-M12/', keywords:'æŠ€èƒ½ æª¢å®š skill M12 12'},
      {section:'skill', group:'æŠ€è—ç«¶è³½', title:'ğŸ› ï¸ M13 æŠ€è—ç«¶è³½', url:'https://hisausage7.github.io/skill-M13/', keywords:'æŠ€èƒ½ æª¢å®š skill M13 13'},
      {section:'skill', group:'æŠ€è—ç«¶è³½', title:'ğŸ› ï¸ M14 æŠ€è—ç«¶è³½', url:'https://hisausage7.github.io/skill-M14/', keywords:'æŠ€èƒ½ æª¢å®š skill M14 14'},
      {section:'skill', group:'æŠ€è—ç«¶è³½', title:'ğŸ› ï¸ M15 æŠ€è—ç«¶è³½', url:'https://hisausage7.github.io/skill-M15/', keywords:'æŠ€èƒ½ æª¢å®š skill M15 15'},
      {section:'skill', group:'æŠ€è—ç«¶è³½', title:'ğŸ› ï¸ M16 æŠ€è—ç«¶è³½', url:'https://hisausage7.github.io/skill-M16/', keywords:'æŠ€èƒ½ æª¢å®š skill M16 16'},
      {section:'skill', group:'æŠ€è—ç«¶è³½', title:'ğŸ› ï¸ M17 æŠ€è—ç«¶è³½', url:'https://hisausage7.github.io/skill-M17/', keywords:'æŠ€èƒ½ æª¢å®š skill M17 17'}
    ];

    var FILTERS = [
      {id:'all', label:'å…¨éƒ¨'},
      {id:'147', label:'147å…¥å­¸è€ƒ'},
      {id:'int', label:'147æ ¡å…§è€ƒ'},
      {id:'test', label:'147æœŸä¸­/æœ«è€ƒ'},
      {id:'caa', label:'147CAA'},
      {id:'skill', label:'æŠ€è—ç«¶è³½'},
      {id:'fav', label:'æ”¶è—'}
    ];

    var LS_FAV = 'portal_favs_v1';
    var LS_REC = 'portal_recent_v1';
    var LS_UI  = 'portal_ui_v1';

    function loadJSON(key, fallback){
      try{
        var raw = localStorage.getItem(key);
        if(!raw) return fallback;
        var obj = JSON.parse(raw);
        return obj || fallback;
      }catch(e){ return fallback; }
    }
    function saveJSON(key, obj){
      try{ localStorage.setItem(key, JSON.stringify(obj)); }catch(e){}
    }

    var favs = loadJSON(LS_FAV, {});
    var recent = loadJSON(LS_REC, []); /* [{url,title,ts}] */
    var ui = loadJSON(LS_UI, { grouped:true, dense:false, sort:'smart' });

    var state = { activeFilter:'all', query:'' };

    var $app = document.getElementById('app');
    var $nav = document.getElementById('nav');
    var $q = document.getElementById('q');
    var $content = document.getElementById('content');
    var $empty = document.getElementById('empty');

    var $statTotal = document.getElementById('statTotal');
    var $statShown = document.getElementById('statShown');
    var $statFav = document.getElementById('statFav');

    var $viewTitle = document.getElementById('viewTitle');
    var $viewSub = document.getElementById('viewSub');

    var $sortSel = document.getElementById('sortSel');
    var $btnGroup = document.getElementById('btnGroup');
    var $btnDense = document.getElementById('btnDense');

    function el(tag, cls){
      var n = document.createElement(tag);
      if(cls) n.className = cls;
      return n;
    }

    function isFav(item){ return !!favs[item.url]; }

    function addRecent(item){
      try{
        var now = Date.now();
        var next = [];
        for(var i=0;i<recent.length;i++){
          if(recent[i] && recent[i].url !== item.url) next.push(recent[i]);
        }
        next.unshift({url:item.url, title:item.title, ts: now});
        if(next.length > 10) next = next.slice(0,10);
        recent = next;
        saveJSON(LS_REC, recent);
      }catch(e){}
    }

    function matchItem(item){
      if(state.activeFilter === 'fav'){
        if(!isFav(item)) return false;
      }else if(state.activeFilter !== 'all'){
        if(item.section !== state.activeFilter) return false;
      }
      var q = (state.query||'').toLowerCase().trim();
      if(!q) return true;
      var hay = (item.title + ' ' + item.keywords + ' ' + item.group).toLowerCase();
      return hay.indexOf(q) > -1;
    }

    function groupBy(arr, keyFn){
      var map = {};
      for(var i=0;i<arr.length;i++){
        var k = keyFn(arr[i]);
        if(!map[k]) map[k]=[];
        map[k].push(arr[i]);
      }
      return map;
    }

    function getRecTs(url){
      for(var i=0;i<recent.length;i++){
        if(recent[i] && recent[i].url === url) return recent[i].ts || 0;
      }
      return 0;
    }

    function sortItems(arr){
      var mode = ui.sort || 'smart';
      var a = arr.slice(0);

      function cmpText(x,y){
        x = (x||'').toLowerCase();
        y = (y||'').toLowerCase();
        if(x<y) return -1;
        if(x>y) return 1;
        return 0;
      }

      a.sort(function(p,q){
        if(mode === 'title'){
          return cmpText(p.title, q.title);
        }
        if(mode === 'group'){
          var g1 = cmpText(p.group, q.group);
          if(g1!==0) return g1;
          return cmpText(p.title, q.title);
        }
        if(mode === 'recent'){
          return (getRecTs(q.url) - getRecTs(p.url)) || cmpText(p.title, q.title);
        }
        if(mode === 'fav'){
          var f1 = (isFav(q)?1:0) - (isFav(p)?1:0);
          if(f1!==0) return f1;
          return cmpText(p.title, q.title);
        }
        /* smartï¼šæ”¶è— > æœ€è¿‘ > æ¨™é¡Œ */
        var sf = (isFav(q)?1:0) - (isFav(p)?1:0);
        if(sf!==0) return sf;
        var sr = (getRecTs(q.url) - getRecTs(p.url));
        if(sr!==0) return sr;
        return cmpText(p.title, q.title);
      });

      return a;
    }

    function countByFilter(id){
      if(id === 'all') return DATA.length;
      if(id === 'fav'){
        var c=0;
        for(var i=0;i<DATA.length;i++) if(isFav(DATA[i])) c++;
        return c;
      }
      var n=0;
      for(var j=0;j<DATA.length;j++) if(DATA[j].section === id) n++;
      return n;
    }

    function getFilterLabel(id){
      for(var i=0;i<FILTERS.length;i++){
        if(FILTERS[i].id === id) return FILTERS[i].label;
      }
      return 'å…¨éƒ¨';
    }

    function buildNav(){
      $nav.innerHTML = '';
      for(var i=0;i<FILTERS.length;i++){
        (function(f){
          var b = el('button','navBtn');
          b.type = 'button';
          if(f.id === state.activeFilter) b.classList.add('active');

          var left = el('div','navLeft');
          var dot = el('span','dot');
          var lab = el('span','navLabel');
          lab.textContent = f.label;

          left.appendChild(dot);
          left.appendChild(lab);

          var badge = el('span','badge');
          badge.textContent = String(countByFilter(f.id));

          b.appendChild(left);
          b.appendChild(badge);

          b.addEventListener('click', function(){
            state.activeFilter = f.id;
            buildNav();
            render();
          });

          $nav.appendChild(b);
        })(FILTERS[i]);
      }
    }

    function renderStats(){
      var total = DATA.length;
      var favCount = 0;
      for(var k in favs){ if(favs.hasOwnProperty(k) && favs[k]) favCount++; }

      var shown = 0;
      for(var i=0;i<DATA.length;i++){ if(matchItem(DATA[i])) shown++; }

      $statTotal.innerHTML = 'ç¸½æ•¸ <b>'+ total +'</b><span class="m">é …</span>';
      $statShown.innerHTML = 'é¡¯ç¤º <b>'+ shown +'</b><span class="m">é …</span>';
      $statFav.innerHTML = 'æ”¶è— <b>'+ favCount +'</b><span class="m">é …</span>';
    }

    function toast(msg){
      var t = document.getElementById('toast');
      if(!t) return;
      t.textContent = msg;
      t.classList.add('show');
      clearTimeout(t._tm);
      t._tm = setTimeout(function(){
        t.classList.remove('show');
      }, 1200);
    }

    function renderRow(item){
      var tr = el('div','tr');

      var td1 = el('div','tTitle');
      var nm = el('div','name');
      nm.textContent = item.title;

      var kw = el('div','kw');
      kw.textContent = item.keywords || '';

      td1.appendChild(nm);
      td1.appendChild(kw);

      var td2 = el('div','tGroup');
      var tag = el('span','tag');
      tag.textContent = item.group;
      td2.appendChild(tag);

      var td3 = el('div','tActs');

      var go = el('a','go');
      go.href = item.url;
      go.target = '_blank';
      go.rel = 'noopener';
      go.textContent = 'é€²å…¥ â†—';
      go.addEventListener('click', function(){ addRecent(item); });

      var fav = el('button','fav');
      fav.type = 'button';
      function syncFav(){
        if(isFav(item)){
          fav.classList.add('on');
          fav.textContent = 'â˜… æ”¶è—';
        }else{
          fav.classList.remove('on');
          fav.textContent = 'â˜† æ”¶è—';
        }
      }
      syncFav();

      fav.addEventListener('click', function(e){
        e.preventDefault();
        e.stopPropagation();

        if(isFav(item)) delete favs[item.url];
        else favs[item.url] = true;

        saveJSON(LS_FAV, favs);
        syncFav();
        renderStats();
        buildNav();
        toast(isFav(item) ? 'å·²åŠ å…¥æ”¶è— â˜…' : 'å·²å–æ¶ˆæ”¶è—');

        if(state.activeFilter === 'fav') render();
      });

      td3.appendChild(go);
      td3.appendChild(fav);

      tr.appendChild(td1);
      tr.appendChild(td2);
      tr.appendChild(td3);
      return tr;
    }

    function renderSection(title, items){
      var sec = el('section','section');

      var head = el('div','sectionHead');
      var nm = el('div','name'); nm.textContent = title;
      var ct = el('div','count'); ct.textContent = items.length + ' é …';
      head.appendChild(nm);
      head.appendChild(ct);

      var table = el('div','table');

      var thead = el('div','thead');
      var c1 = el('div'); c1.textContent = 'æ¨™é¡Œ';
      var c2 = el('div'); c2.textContent = 'åˆ†é¡';
      var c3 = el('div'); c3.textContent = 'æ“ä½œ';
      thead.appendChild(c1); thead.appendChild(c2); thead.appendChild(c3);

      table.appendChild(thead);

      for(var i=0;i<items.length;i++){
        table.appendChild(renderRow(items[i]));
      }

      sec.appendChild(head);
      sec.appendChild(table);
      return sec;
    }

    function renderFlat(list){
      $content.appendChild(renderSection('æ¸…å–®', list));
    }

    function renderGrouped(list){
      var grouped = groupBy(list, function(it){ return it.group; });
      var order = ['147å…¥å­¸è€ƒ','147æ ¡å…§è€ƒ','147æœŸä¸­/æœ«è€ƒ','147CAA','æŠ€è—ç«¶è³½'];

      for(var i=0;i<order.length;i++){
        var g = order[i];
        if(grouped[g] && grouped[g].length){
          $content.appendChild(renderSection(g, grouped[g]));
        }
      }
      for(var k in grouped){
        if(!grouped.hasOwnProperty(k)) continue;
        var inOrder = false;
        for(var j=0;j<order.length;j++){ if(order[j]===k){ inOrder=true; break; } }
        if(inOrder) continue;
        $content.appendChild(renderSection(k, grouped[k]));
      }
    }

    function applyUI(){
      if(ui.dense) $app.classList.add('dense');
      else $app.classList.remove('dense');

      $btnGroup.textContent = ui.grouped ? 'ç¾¤çµ„ï¼šé–‹' : 'ç¾¤çµ„ï¼šé—œ';
      if(ui.grouped) $btnGroup.classList.add('on'); else $btnGroup.classList.remove('on');

      $btnDense.textContent = ui.dense ? 'å¯†åº¦ï¼šé«˜' : 'å¯†åº¦ï¼šä¸€èˆ¬';
      if(ui.dense) $btnDense.classList.add('on'); else $btnDense.classList.remove('on');

      $sortSel.value = ui.sort || 'smart';
    }

    function animateIn(){
      var prefersReduce = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      if(prefersReduce) return;

      var secs = document.querySelectorAll('.section');
      for(var i=0;i<secs.length;i++){
        (function(node, idx){
          node.classList.remove('in');
          node.style.transitionDelay = (idx*28) + 'ms';
          setTimeout(function(){ node.classList.add('in'); }, 10);
        })(secs[i], i);
      }

      var rows = document.querySelectorAll('.tr');
      for(var j=0;j<rows.length;j++){
        (function(node, idx){
          node.classList.remove('in');
          node.style.transitionDelay = (Math.min(idx,20)*16) + 'ms';
          setTimeout(function(){ node.classList.add('in'); }, 10);
        })(rows[j], j);
      }
    }

    function render(){
      $content.innerHTML = '';
      $empty.style.display = 'none';

      var label = getFilterLabel(state.activeFilter);
      $viewTitle.textContent = label;

      var q = (state.query||'').trim();
      $viewSub.textContent = q ? ('æœå°‹ï¼šã€Œ'+ q +'ã€ï½œå¯æ’åº/ç¾¤çµ„/å¯†åº¦') : 'ALL';

      var list = [];
      for(var i=0;i<DATA.length;i++){
        if(matchItem(DATA[i])) list.push(DATA[i]);
      }

      list = sortItems(list);
      renderStats();

      /* all + ç„¡æœå°‹ï¼šæŠŠæ”¶è—/æœ€è¿‘ç•¶ã€Œç³»çµ±å€ã€æ”¾æœ€ä¸Š */
      if(state.activeFilter === 'all' && q === ''){
        var favItems = [];
        for(var a=0;a<DATA.length;a++) if(isFav(DATA[a])) favItems.push(DATA[a]);
        favItems = sortItems(favItems);
        if(favItems.length){
          $content.appendChild(renderSection('â˜… æ”¶è—', favItems));
        }

        var recItems = [];
        for(var r=0;r<recent.length;r++){
          var ru = recent[r] && recent[r].url;
          if(!ru) continue;
          for(var j=0;j<DATA.length;j++){
            if(DATA[j].url === ru){
              recItems.push(DATA[j]);
              break;
            }
          }
        }
        recItems = sortItems(recItems);
        if(recItems.length){
          $content.appendChild(renderSection('â±ï¸ æœ€è¿‘é–‹å•Ÿ', recItems));
        }
      }

      if(list.length === 0){
        $empty.style.display = 'block';
        return;
      }

      if(ui.grouped) renderGrouped(list);
      else renderFlat(list);

      setTimeout(animateIn, 0);
    }

    /* ===== UI controls ===== */
    $btnGroup.addEventListener('click', function(){
      ui.grouped = !ui.grouped;
      saveJSON(LS_UI, ui);
      applyUI();
      render();
    });

    $btnDense.addEventListener('click', function(){
      ui.dense = !ui.dense;
      saveJSON(LS_UI, ui);
      applyUI();
    });

    $sortSel.addEventListener('change', function(){
      ui.sort = $sortSel.value || 'smart';
      saveJSON(LS_UI, ui);
      render();
    });

    /* æœå°‹ */
    $q.addEventListener('input', function(){
      state.query = $q.value || '';
      render();
    });

    /* å¿«æ·éµ */
    document.addEventListener('keydown', function(e){
      if(e.key === '/' && document.activeElement !== $q){
        e.preventDefault();
        $q.focus();
        return;
      }
      if(e.key === 'Escape'){
        if(($q.value||'')!==''){
          $q.value='';
          state.query='';
          render();
        }
        if(document.activeElement === $q) $q.blur();
      }
    });

    /* Rippleï¼šäº‹ä»¶å§”æ´¾ï¼ˆbtn/nav/go/fav éƒ½æœ‰æ°´æ³¢ï¼‰ */
    function makeRipple(elm){
      if(!elm || !elm.classList) return;
      if(!elm.classList.contains('ripple')) elm.classList.add('ripple');
    }
    function fireRipple(elm, clientX, clientY){
      if(!elm) return;
      makeRipple(elm);

      var r = elm.getBoundingClientRect();
      var size = Math.max(r.width, r.height);
      var x = clientX - r.left - size/2;
      var y = clientY - r.top - size/2;

      var s = document.createElement('span');
      s.className = 'rip';
      s.style.width = size + 'px';
      s.style.height = size + 'px';
      s.style.left = x + 'px';
      s.style.top = y + 'px';

      elm.appendChild(s);
      setTimeout(function(){
        try{ elm.removeChild(s); }catch(e){}
      }, 560);
    }
    document.addEventListener('click', function(e){
      var t = e.target;
      while(t && t !== document.body){
        if(t.classList && (t.classList.contains('btn') || t.classList.contains('navBtn') || t.classList.contains('go') || t.classList.contains('fav'))){
          fireRipple(t, e.clientX, e.clientY);
          break;
        }
        t = t.parentNode;
      }
    }, true);

    /* æ™‚é˜ */
    (function(){
      var elp = document.getElementById('clockPill');
      function pad(n){ return (n<10?'0':'')+n; }
      function tick(){
        try{
          var d = new Date();
          var days = ['æ—¥','ä¸€','äºŒ','ä¸‰','å››','äº”','å…­'];
          var s = d.getFullYear()+'/'+pad(d.getMonth()+1)+'/'+pad(d.getDate())+' (é€±'+days[d.getDay()]+') '+pad(d.getHours())+':'+pad(d.getMinutes())+':'+pad(d.getSeconds());
          elp.innerHTML = 'ğŸ•’ <span class="mut">'+ s +'</span>';
        }catch(e){}
      }
      tick();
      setInterval(tick, 1000);
    })();

    /* å¤©æ°£ï¼ˆè‡ºä¸­ï¼‰ */
    (function(){
      var pill = document.getElementById('weatherPill');
      try{ pill.classList.add('loading'); }catch(e){}

      function wxMap(code,isNight){
        var map={
          0:{e:'â˜€ï¸',t:'æ™´æœ—'},1:{e:'ğŸŒ¤ï¸',t:'å¤šé›²æ™‚æ™´'},2:{e:'â›…',t:'é™°æ™´ä¸å®š'},3:{e:'â˜ï¸',t:'å¤šé›²'},
          45:{e:'ğŸŒ«ï¸',t:'éœ§'},48:{e:'ğŸŒ«ï¸',t:'éœ§'},
          51:{e:'ğŸŒ¦ï¸',t:'ç´°é›¨'},53:{e:'ğŸŒ¦ï¸',t:'æ¯›æ¯›é›¨'},55:{e:'ğŸŒ§ï¸',t:'å°é›¨'},
          61:{e:'ğŸŒ§ï¸',t:'å°é›¨'},63:{e:'ğŸŒ§ï¸',t:'ä¸­é›¨'},65:{e:'ğŸŒ§ï¸',t:'å¤§é›¨'},
          71:{e:'ğŸŒ¨ï¸',t:'å°é›ª'},73:{e:'ğŸŒ¨ï¸',t:'ä¸­é›ª'},75:{e:'â„ï¸',t:'å¤§é›ª'},
          80:{e:'ğŸŒ¦ï¸',t:'é™£é›¨'},81:{e:'ğŸŒ§ï¸',t:'é™£é›¨'},82:{e:'ğŸŒ§ï¸',t:'è±ªé›¨'},
          95:{e:'â›ˆï¸',t:'é›·é›¨'},96:{e:'â›ˆï¸',t:'é›·é›¨å†°é›¹'},99:{e:'â›ˆï¸',t:'å¼·é›·é›¹'}
        };
        var item = map[code] || {e:(isNight?'ğŸŒ™':'â˜€ï¸'), t:'å¤©æ°£'};
        if(isNight && (code===0 || code===1)) item.e='ğŸŒ™';
        return item;
      }

      function fetchTaichung(){
        var lat = 24.067337599276396;
        var lon = 120.71470802813444;
        var url = 'https://api.open-meteo.com/v1/forecast?latitude='+lat+'&longitude='+lon+'&current=temperature_2m,weather_code,is_day';
        fetch(url).then(function(res){
          if(!res.ok) throw new Error('network');
          return res.json();
        }).then(function(data){
          var cur = data.current || {};
          var code = (cur.weather_code!=null?cur.weather_code:0);
          var temp = Math.round(cur.temperature_2m!=null?cur.temperature_2m:0);
          var isNight = (cur.is_day===0);
          var m = wxMap(code, isNight);
          pill.innerHTML = m.e + ' <span class="mut">è‡ºä¸­ï½œ'+ m.t +'ãƒ»'+ temp +'Â°C</span>';
          try{ pill.classList.remove('loading'); }catch(e){}
        }).catch(function(){
          pill.innerHTML = 'âš ï¸ <span class="mut">å¤©æ°£å–å¾—å¤±æ•—</span>';
          try{ pill.classList.remove('loading'); }catch(e){}
        });
      }
      fetchTaichung();
    })();

    /* init */
    applyUI();
    buildNav();
    render();
  </script>
</body>
</html>

